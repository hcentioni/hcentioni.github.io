"use strict";(self.webpackChunkpreventasweb=self.webpackChunkpreventasweb||[]).push([[592],{6575:(I,u,r)=>{r.d(u,{n:()=>h});var n=r(9808),l=r(2382),i=r(1980),p=r(1728),c=r(4893);let h=(()=>{class a{}return a.\u0275fac=function(_){return new(_||a)},a.\u0275mod=c.oAB({type:a}),a.\u0275inj=c.cJS({imports:[[n.ez,l.UX,l.u5,i.TXv,i.ga2,i.hJ1,i.dTQ,i.kWm,i.ejP,i.zE6,i.Xo8,i.q4M,i.m81,i.FxY,p.QX,i.Fme]]}),a})()},5018:(I,u,r)=>{r.d(u,{z:()=>a});var n=r(4893),l=r(2340),i=r(1781),c=r(520),h=r(629);let a=(()=>{class e{constructor(t,o){this.http=t,this.apiAuth=o,this.disparadorCarrito=new n.vpe,this.url=l.N.API_URL}initPedido(t){if(this.userData=this.apiAuth.getUserData(),localStorage.getItem("carrito")){let o=this.getCarrito();o&&(this.pedido=o.IdCliente==t?o:{IdCliente:t,IdVendedor:this.userData.IdVendedor,SubTotalNeto:0,NetoGrabado:0,Iva:0,Total:0,Dto:0,IdUsuario:this.userData.IdClienteContacto,IdMoneda:2,Nota:"",Productos:[],CantidadItems:0,ControlaStock:0,Distribuidor:1,IdOrigen:4})}else this.pedido={IdCliente:t,IdVendedor:this.userData.IdVendedor,SubTotalNeto:0,NetoGrabado:0,Iva:0,Total:0,Dto:0,IdUsuario:this.userData.IdClienteContacto,IdMoneda:2,Nota:"",Productos:[],CantidadItems:0,ControlaStock:0,Distribuidor:1,IdOrigen:4}}loadCarrrito(t){this.initPedido(t),this.calcularPedido()}addCarrito(){}addProduct(t,o){const d=this.pedido.Productos.find(s=>s.producto.IdArticulo===t.IdArticulo);if(d)d.cantidad=o,d.producto.SubTotal=o*d.producto.P_FinalDto2;else{const s={cantidad:o,producto:t};t.SubTotal=o*t.P_FinalDto2,this.pedido.Productos.push(s)}localStorage.setItem("carrito",JSON.stringify(this.pedido)),this.calcularPedido(),this.disparadorCarrito.emit()}deleteProduct(t){const o=this.pedido.Productos.find(d=>d.producto.IdArticulo===t.IdArticulo);if(o){let d=this.pedido.Productos.indexOf(o);this.pedido.Productos.splice(d,1),localStorage.setItem("carrito",JSON.stringify(this.pedido))}this.calcularPedido(),this.disparadorCarrito.emit()}getCarrito(){return localStorage.getItem("carrito")?this.pedido=JSON.parse(localStorage.getItem("carrito")):this.initPedido(0),this.pedido}calcularPedido(){let o=0,d=0;this.pedido.Productos.forEach(s=>{d+=s.cantidad,o+=s.producto.P_FinalDto2*s.cantidad}),this.pedido.SubTotalNeto=0,this.pedido.NetoGrabado=0,this.pedido.Dto=0,this.pedido.Iva=0,this.pedido.Total=o,this.pedido.CantidadItems=d,localStorage.setItem("carrito",JSON.stringify(this.pedido)),this.disparadorCarrito.emit()}clearPedido(){localStorage.removeItem("carrito")}pedidosGet(t){return this.http.get(this.url+`api/pedidos/search?${i.stringify(t)}`)}pedidoDetalleGet(t){return this.http.get(this.url+`api/pedidos/${t}`)}grabarCarrito(){return this.http.post(this.url+"api/orders/",this.pedido)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(c.eN),n.LFG(h.e))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);